select * from PO_HRIS_DB."survey".PO_ANNIVERSARY_SURVEY

Create or Replace Table PO_ANNIVERSARY_SURVEY_FY20
(
StartDate Varchar,
EndDate Varchar,
Status Varchar,
Progress Varchar,
Duration Varchar,
Finished Varchar,
RecordedDate Varchar,
ResponseId Varchar,
NPS_EMP Varchar,
NPS_MOV Varchar,
NPS_TV Varchar,
CARE_EMP Varchar,
HAP_SPE Varchar,
ASK_HLP Varchar,
PCE_ORG Varchar,
TLS_RSC Varchar,
WRK_OBST Varchar,
TLT_STR Varchar,
WRK_MNG Varchar,
WRK_LNG Varchar,
OPN_MAT Varchar,
IDEA_SHR Varchar,
PRS_REC Varchar,
JOB_EXP Varchar,
CNTR_SUC Varchar,
ACNT_RSLT Varchar,
HON_DISC Varchar,
MGR_FDB Varchar,
MGR_RCMMD Varchar,
GRW_CAR Varchar,
CLR_PTH Varchar,
CAR_GLS Varchar,
CAR_OPP Varchar,
DIV_EXC Varchar,
UND_STRT Varchar,
DEC_TIME Varchar,
VALUE_SPE Varchar,
LDR_CONF Varchar,
SONY_EXC Varchar,
CUST_NEED Varchar,
CUST_VALUE Varchar,
ENV_INV Varchar,
DIF_OPN Varchar,
CRE_APR Varchar,
IDEA_QCK Varchar,
TEAM_COLLAB Varchar,
LRN_GRW Varchar,
EMP_INF Varchar,
INF_SHR Varchar,
LDR_DIV Varchar,
WRK_LFE Varchar,
XTR_EFF Varchar,
CULT_SPE Varchar,
SVY_ACT Varchar,
ENV_SUST Varchar,
TKE_RSK Varchar,
FEEL_FREE Varchar,
Q47 Varchar,
Q48 Varchar,
Q49 Varchar,
Q50 Varchar,
SGST_INV Varchar,
CAR_PTH Varchar,
Anniversary_Date Varchar,
Participant_Email Varchar,
Batch_ID Number,
Source_FileName Varchar
);

select * from PO_ANNIVERSARY_SURVEY_FY22
Create or Replace Table PO_ANNIVERSARY_SURVEY_FY21
(
Start_Date Varchar,
End_Date Varchar,
Status Varchar,
Progress Varchar,
Duration Varchar,
Finished Varchar,
Recorded_Date Varchar,
Response_Id Varchar,
NPS_EMP Varchar,
NPS_MOV Varchar,
NPS_TV Varchar,
CARE_EMP Varchar,
HAP_SPE Varchar,
PCE_ORG Varchar,
TLS_RSC Varchar,
WRK_OBST Varchar,
TLT_STR Varchar,
WRK_MNG Varchar,
WRK_LNG Varchar,
OPN_MAT Varchar,
IDEA_SHR Varchar,
PRS_REC Varchar,
HON_DISC Varchar,
MGR_FDB Varchar,
JOB_EXP Varchar,
MGR_RCMMD Varchar,
GRW_CAR Varchar,
CAR_PTH Varchar,
CAR_GLS Varchar,
CAR_OPP Varchar,
DIV_EXC Varchar,
UND_STRT Varchar,
DEC_TIME Varchar,
VALUE_SPE Varchar,
LDR_CONF Varchar,
SONY_EXC Varchar,
CUST_NEED Varchar,
CUST_VALUE Varchar,
ENV_INV Varchar,
SGST_INV Varchar,
CRE_APR Varchar,
IDEA_QCK Varchar,
TEAM_COLLAB Varchar,
EMP_INF Varchar,
INF_SHR Varchar,
LDR_DIV Varchar,
WRK_LFE Varchar,
XTR_EFF Varchar,
CULT_SPE Varchar,
SVY_ACT Varchar,
ENV_SUST Varchar,
FEEL_FREE Varchar,
Q47 Varchar,
Q48 Varchar,
Q49 Varchar,
Q50 Varchar,
Anniversary_Date Varchar,
Employee_ID Varchar,
Participant_Unique_Identifier Varchar,
Fiscal_Year Varchar,
FY_Quarter Varchar,
NPS_Category Varchar,
NPS_Mov_Category Varchar,
NPS_TV_Category Varchar,
Batch_ID Number,
Source_FileName Varchar
);

//truncate table PO_ANNIVERSARY_SURVEY_FY21;

select * from PO_ANNIVERSARY_SURVEY_FY21
;
INSERT INTO PO_ANNIVERSARY_SURVEY_FY21
(
Start_Date,
End_Date,
Status,
Progress,
Duration,
Finished,
Recorded_Date,
Response_Id,
NPS_EMP,
NPS_MOV,
NPS_TV,
CARE_EMP,
HAP_SPE,
PCE_ORG,
TLS_RSC,
WRK_OBST,
TLT_STR,
WRK_MNG,
WRK_LNG,
OPN_MAT,
IDEA_SHR,
PRS_REC,
HON_DISC,
MGR_FDB,
JOB_EXP,
MGR_RCMMD,
GRW_CAR,
CAR_PTH,
CAR_GLS,
CAR_OPP,
DIV_EXC,
UND_STRT,
DEC_TIME,
VALUE_SPE,
LDR_CONF,
SONY_EXC,
CUST_NEED,
CUST_VALUE,
ENV_INV,
SGST_INV,
CRE_APR,
IDEA_QCK,
TEAM_COLLAB,
EMP_INF,
INF_SHR,
LDR_DIV,
WRK_LFE,
XTR_EFF,
CULT_SPE,
SVY_ACT,
ENV_SUST,
FEEL_FREE,
Q47,
Q48,
Q49,
Q50,
Anniversary_Date,
Employee_ID,
Participant_Unique_Identifier,
Fiscal_Year,
FY_Quarter,
NPS_Category,
NPS_Mov_Category,
NPS_TV_Category,
Batch_ID ,
Source_FileName 
)
select
$1,
$2,
$3,
$4,
$5,
$6,
$7,
$8,
$9,
$10,
$11,
$12,
$13,
$14,
$15,
$16,
$17,
$18,
$19,
$20,
$21,
$22,
$23,
$24,
$25,
$26,
$27,
$28,
$29,
$30,
$31,
$32,
$33,
$34,
$35,
$36,
$37,
$38,
$39,
$40,
$41,
$42,
$43,
$44,
$45,
$46,
$47,
$48,
$49,
$50,
$51,
$52,
$53,
$54,
$55,
$56,
$57,
$58,
$59,
$60,
$61,
$62,
$63,
$64,
20231102,
METADATA$FILENAME
from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/Anniversary_Survey_FY2021_hashed_20231103.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t;

select
$1,
$2,
$3,
$4,
$5,
$6,
$7,
$8,
$9,
$10,
$11,
$12,
$13,
$14,
$15,
$16,
$17,
$18,
$19,
$20,
$21,
$22,
$23,
$24,
$25,
$26,
$27,
$28,
$29,
$30,
$31,
$32,
$33,
$34,
$35,
$36,
$37,
$38,
$39,
$40,
$41,
$42,
$43,
$44,
$45,
$46,
$47,
$48,
$49,
$50,
$51,
$52,
$53,
$54,
$55,
$56,
$57,
$58,
$59,
$60,
$61,
$62,
$63,
$64,
20231102,
METADATA$FILENAME
from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/Anniversary_Survey_FY2021_hashed_20231103.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t;


Create or Replace Table PO_ANNIVERSARY_SURVEY_FY23
(
StartDate Varchar,
EndDate Varchar,
Status Varchar,
Progress Varchar,
Duration Varchar,
Finished Varchar,
RecordedDate Varchar,
ResponseId Varchar,
NPS_EMP Varchar,
NPS_MOV Varchar,
NPS_TV Varchar,
CARE_EMP Varchar,
HAP_SPE Varchar,
ASK_HLP Varchar,
PCE_ORG Varchar,
TLS_RSC Varchar,
WRK_OBST Varchar,
TLT_STR Varchar,
WRK_MNG Varchar,
WRK_LNG Varchar,
OPN_MAT Varchar,
IDEA_SHR Varchar,
PRS_REC Varchar,
JOB_EXP Varchar,
CNTR_SUC Varchar,
ACNT_RSLT Varchar,
HON_DISC Varchar,
MGR_FDB Varchar,
MGR_RCMMD Varchar,
GRW_CAR Varchar,
CLR_PTH Varchar,
CAR_GLS Varchar,
CAR_OPP Varchar,
DIV_EXC Varchar,
UND_STRT Varchar,
DEC_TIME Varchar,
VALUE_SPE Varchar,
LDR_CONF Varchar,
SONY_EXC Varchar,
CUST_NEED Varchar,
CUST_VALUE Varchar,
ENV_INV Varchar,
DIF_OPN Varchar,
CRE_APR Varchar,
IDEA_QCK Varchar,
TEAM_COLLAB Varchar,
LRN_GRW Varchar,
EMP_INF Varchar,
INF_SHR Varchar,
LDR_DIV Varchar,
WRK_LFE Varchar,
XTR_EFF Varchar,
CULT_SPE Varchar,
SVY_ACT Varchar,
ENV_SUST Varchar,
TKE_RSK Varchar,
FEEL_FREE Varchar,
Q47 Varchar,
Q48 Varchar,
Q49 Varchar,
Q50 Varchar,
eNPS_EMP Varchar,
eNPS_MOV Varchar,
eNPS_TV Varchar,
Q1_1 Varchar,
Q1_2 Varchar,
Q1_3 Varchar,
Q1_4 Varchar,
Q1_5 Varchar,
Q1_6 Varchar,
Q1_7 Varchar,
Q2_1 Varchar,
Q2_2 Varchar,
Q2_3 Varchar,
Q2_4 Varchar,
Q2_5 Varchar,
Q2_6 Varchar,
Q2_7 Varchar,
Q5_1 Varchar,
Q5_2 Varchar,
Q5_3 Varchar,
Q5_4 Varchar,
Q5_5 Varchar,
Q5_6 Varchar,
Q6_1 Varchar,
Q6_2 Varchar,
Q6_3 Varchar,
Q6_4 Varchar,
Q6_5 Varchar,
Q6_6 Varchar,
Q6_7 Varchar,
Q7_1 Varchar,
Q7_2 Varchar,
Q7_3 Varchar,
Q7_4 Varchar,
Q7_5 Varchar,
Q7_6 Varchar,
Q8_1 Varchar,
Q8_2 Varchar,
Q8_3 Varchar,
Q8_4 Varchar,
Q8_5 Varchar,
Q8_6 Varchar,
Q3_1 Varchar,
Q3_2 Varchar,
Q3_3 Varchar,
Q3_4 Varchar,
Q3_5 Varchar,
Q3_6 Varchar,
Q3_7 Varchar,
Q4 Varchar,
Q73 Varchar,
Q74 Varchar,
Q75 Varchar,
Anniversary_Date Varchar,
Employee_ID Varchar,
Participant_Unique_Identifier Varchar,
FY_Quarter Varchar,
Fiscal_Year Varchar,
eNPS_Category Varchar,
eNPS_Movie_Category Varchar,
eNPS_TV_Category Varchar,
Filename Varchar,
Batch_id number
);

INSERT INTO PO_ANNIVERSARY_SURVEY_FY23
(
StartDate,
EndDate,
Status,
Progress,
Duration,
Finished,
RecordedDate,
ResponseId,
NPS_EMP,
NPS_MOV,
NPS_TV,
CARE_EMP,
HAP_SPE,
ASK_HLP,
PCE_ORG,
TLS_RSC,
WRK_OBST,
TLT_STR,
WRK_MNG,
WRK_LNG,
OPN_MAT,
IDEA_SHR,
PRS_REC,
JOB_EXP,
CNTR_SUC,
ACNT_RSLT,
HON_DISC,
MGR_FDB,
MGR_RCMMD,
GRW_CAR,
CLR_PTH,
CAR_GLS,
CAR_OPP,
DIV_EXC,
UND_STRT,
DEC_TIME,
VALUE_SPE,
LDR_CONF,
SONY_EXC,
CUST_NEED,
CUST_VALUE,
ENV_INV,
DIF_OPN,
CRE_APR,
IDEA_QCK,
TEAM_COLLAB,
LRN_GRW,
EMP_INF,
INF_SHR,
LDR_DIV,
WRK_LFE,
XTR_EFF,
CULT_SPE,
SVY_ACT,
ENV_SUST,
TKE_RSK,
FEEL_FREE,
Q47,
Q48,
Q49,
Q50,
eNPS_EMP,
eNPS_MOV,
eNPS_TV,
Q1_1,
Q1_2,
Q1_3,
Q1_4,
Q1_5,
Q1_6,
Q1_7,
Q2_1,
Q2_2,
Q2_3,
Q2_4,
Q2_5,
Q2_6,
Q2_7,
Q5_1,
Q5_2,
Q5_3,
Q5_4,
Q5_5,
Q5_6,
Q6_1,
Q6_2,
Q6_3,
Q6_4,
Q6_5,
Q6_6,
Q6_7,
Q7_1,
Q7_2,
Q7_3,
Q7_4,
Q7_5,
Q7_6,
Q8_1,
Q8_2,
Q8_3,
Q8_4,
Q8_5,
Q8_6,
Q3_1,
Q3_2,
Q3_3,
Q3_4,
Q3_5,
Q3_6,
Q3_7,
Q4,
Q73,
Q74,
Q75,
Anniversary_Date,
Employee_ID,
Participant_Unique_Identifier,
FY_Quarter,
Fiscal_Year,
eNPS_Category,
eNPS_Movie_Category,
eNPS_TV_Category,
Filename,
Batch_ID
)
select
$1,
$2,
$3,
$4,
$5,
$6,
$7,
$8,
$9,
$10,
$11,
$12,
$13,
$14,
$15,
$16,
$17,
$18,
$19,
$20,
$21,
$22,
$23,
$24,
$25,
$26,
$27,
$28,
$29,
$30,
$31,
$32,
$33,
$34,
$35,
$36,
$37,
$38,
$39,
$40,
$41,
$42,
$43,
$44,
$45,
$46,
$47,
$48,
$49,
$50,
$51,
$52,
$53,
$54,
$55,
$56,
$57,
$58,
$59,
$60,
$61,
$62,
$63,
$64,
$65,
$66,
$67,
$68,
$69,
$70,
$71,
$72,
$73,
$74,
$75,
$76,
$77,
$78,
$79,
$80,
$81,
$82,
$83,
$84,
$85,
$86,
$87,
$88,
$89,
$90,
$91,
$92,
$93,
$94,
$95,
$96,
$97,
$98,
$99,
$100,
$101,
$102,
$103,
$104,
$105,
$106,
$107,
$108,
$109,
$110,
$111,
$112,
$113,
$114,
$115,
$116,
$117,
$118,
$119,
$120,
$121,
$122,

/*$124,
$125,
$126,
$127,
$128,
$129,
$130,
$131,
$132,
$133,
$134,
$135,
$136,
$137,
$138,
$139,
$140,
$141,
$142,
$143,
$144,
$145,
$146,
$147,
$148,
$149,
$150,
$151,
$152,
$153,
$154,
$155,
$156,
$157,
$158,
$159,
$160,
$161,
$162,
$163,
$164,
$165,
$166,
$167,
$168,
$169,
$170,
$171,
$172,
$173,*/

METADATA$FILENAME,
20231102
from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/Anniversary_Survey_FY2023_hashed_20231103.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t;


Create or Replace Table PO_ANNIVERSARY_SURVEY_FY22
(
StartDate Varchar,
EndDate Varchar,
Status Varchar,
Progress Varchar,
Duration Varchar,
Finished Varchar,
RecordedDate Varchar,
ResponseId Varchar,
NPS_EMP Varchar,
NPS_MOV Varchar,
NPS_TV Varchar,
CARE_EMP Varchar,
HAP_SPE Varchar,
ASK_HLP Varchar,
PCE_ORG Varchar,
TLS_RSC Varchar,
WRK_OBST Varchar,
TLT_STR Varchar,
WRK_MNG Varchar,
WRK_LNG Varchar,
OPN_MAT Varchar,
IDEA_SHR Varchar,
PRS_REC Varchar,
JOB_EXP Varchar,
CNTR_SUC Varchar,
ACNT_RSLT Varchar,
HON_DISC Varchar,
MGR_FDB Varchar,
MGR_RCMMD Varchar,
GRW_CAR Varchar,
CLR_PTH Varchar,
CAR_GLS Varchar,
CAR_OPP Varchar,
DIV_EXC Varchar,
UND_STRT Varchar,
DEC_TIME Varchar,
VALUE_SPE Varchar,
LDR_CONF Varchar,
SONY_EXC Varchar,
CUST_NEED Varchar,
CUST_VALUE Varchar,
ENV_INV Varchar,
DIF_OPN Varchar,
CRE_APR Varchar,
IDEA_QCK Varchar,
TEAM_COLLAB Varchar,
LRN_GRW Varchar,
EMP_INF Varchar,
INF_SHR Varchar,
LDR_DIV Varchar,
WRK_LFE Varchar,
XTR_EFF Varchar,
CULT_SPE Varchar,
SVY_ACT Varchar,
ENV_SUST Varchar,
TKE_RSK Varchar,
FEEL_FREE Varchar,
Q47 Varchar,
Q48 Varchar,
Q49 Varchar,
Q50 Varchar,
Anniversary_Date Varchar,
Employee_ID Varchar,
Participant_Unique_Identifier Varchar,
FY_Quarter Varchar,
Fiscal_Year Varchar,
NPS_Category Varchar,
NPS_Movie_Category Varchar,
NPS_TV_Category Varchar,
Filename Varchar,
Batch_id number
)
;

select * from PO_ANNIVERSARY_SURVEY_FY22
INSERT INTO PO_ANNIVERSARY_SURVEY_FY22
(
StartDate,
EndDate,
Status,
Progress,
Duration,
Finished,
RecordedDate,
ResponseId,
NPS_EMP,
NPS_MOV,
NPS_TV,
CARE_EMP,
HAP_SPE,
ASK_HLP,
PCE_ORG,
TLS_RSC,
WRK_OBST,
TLT_STR,
WRK_MNG,
WRK_LNG,
OPN_MAT,
IDEA_SHR,
PRS_REC,
JOB_EXP,
CNTR_SUC,
ACNT_RSLT,
HON_DISC,
MGR_FDB,
MGR_RCMMD,
GRW_CAR,
CLR_PTH,
CAR_GLS,
CAR_OPP,
DIV_EXC,
UND_STRT,
DEC_TIME,
VALUE_SPE,
LDR_CONF,
SONY_EXC,
CUST_NEED,
CUST_VALUE,
ENV_INV,
DIF_OPN,
CRE_APR,
IDEA_QCK,
TEAM_COLLAB,
LRN_GRW,
EMP_INF,
INF_SHR,
LDR_DIV,
WRK_LFE,
XTR_EFF,
CULT_SPE,
SVY_ACT,
ENV_SUST,
TKE_RSK,
FEEL_FREE,
Q47,
Q48,
Q49,
Q50,
Anniversary_Date,
Employee_ID,
Participant_Unique_Identifier,
FY_Quarter,
Fiscal_Year,
NPS_Category,
NPS_Movie_Category,
NPS_TV_Category,
FIlename,
batch_id
)
select
$1,
$2,
$3,
$4,
$5,
$6,
$7,
$8,
$9,
$10,
$11,
$12,
$13,
$14,
$15,
$16,
$17,
$18,
$19,
$20,
$21,
$22,
$23,
$24,
$25,
$26,
$27,
$28,
$29,
$30,
$31,
$32,
$33,
$34,
$35,
$36,
$37,
$38,
$39,
$40,
$41,
$42,
$43,
$44,
$45,
$46,
$47,
$48,
$49,
$50,
$51,
$52,
$53,
$54,
$55,
$56,
$57,
$58,
$59,
$60,
$61,
$62,
$63,
$64,
$65,
$66,
$67,
$68,
$69,
METADATA$FILENAME,
20231102
from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/Anniversary_Survey_FY2022_hashed_20231103.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t;

Create or Replace Table PO_Survey_Participant
(
Employee_Id Varchar,
Survey Varchar,
Fiscal_Year Varchar,
Source_FileName Varchar,
Created_Datetime timestamp_ntz,
Created_By Varchar(100),
Modified_Datetime timestamp_ntz,
Modified_By Varchar(100),
Batch_ID Integer
)

select * from PO_Survey_Participant group by 2;

INSERT INTO PO_Survey_Participant
(
Employee_Id ,
Survey ,
Fiscal_Year ,
Source_FileName ,
Created_Datetime ,
Created_By ,
Modified_Datetime ,
Modified_By ,
Batch_ID 

)
select $1,'Anniversary','FY24',METADATA$FILENAME,current_timestamp,current_user,current_timestamp,current_user,20231106 from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/QL_Participant_Anniversary_20231019_hashed.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t
union all
select $1,'Exit',null,METADATA$FILENAME,current_timestamp,current_user,current_timestamp,current_user,20231106 from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/QL_Participant_Exit_20231019_hashed.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t
union all
select $1,'New_Hire_90Day',null,METADATA$FILENAME,current_timestamp,current_user,current_timestamp,current_user,20231106 from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/QL_Participant_New_Hire_3_Mth_20231019_hashed.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t
union all
select $1,'New_Hire_14Day',null,METADATA$FILENAME,current_timestamp,current_user,current_timestamp,current_user,20231106 from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/QL_Participant_New_Hire_14Day_20231019_hashed.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t;

select 
$1,
$2,
$3,
$4,
$5,
$6,
$7,
$8,
$9,
$10,
$11,
$12,
$13,
$14,
$15,
$16,
$17,
$18,
$19,
$20,
$21,
$22,
$23,
$24,
$25,
$26,
$27,
$28,
$29,
$30,
$31,
$32,
$33,
$34,
$35,
$36,
$37,
$38,
$39,
$40,
$41,
$42,
$43,
$44,
$45,
$46,
$47,
$48,
$49,
$50,
$51,
$52,
$53,
$54,
$55,
$56,
$57,
$58,
$59,
$60,
$61,
$62,
$63,
$64,
$65,
$66,
$67,
$68,
$69,
$70,
$71,
$72,
$73,
$74,
$75,
$76,
$77,
$78,
$79,
$80,
$81,
$82,
$83,
$84,
$85,
$86,
$87,
$88,
$89,
$90,
$91,
$92,
$93,
$94,
$95,
$96,
$97,
$98,
$99,
$100,
$101,
$102,
$103,
$104,
$105,
$106,
$107,
$108,
$109,
$110,
$111,
$112,
$113,
$114,
$115,
$116,
$117,
$118,
$119,
$120,
$121,
$122,
$123,
$124,
$125,
$126,
$127,
$128,
$129,
$130,
$131,
$132,
$133,
$134,
$135,
$136,
$137,
$138,
$139,
$140,
$141,
$142,
$143,
$144,
$145,
$146,
$147,
$148,
$149,
$150,
$151,
$152,
$153,
$154,
$155,
$156,
$157,
$158,
$159,
$160,
$161,
$162,
$163,
$164,
$165,
$166,
$167,
$168,
$169,
$170,
$171,
$172,
$173
from
@PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/QL_Survey_Anniversary_20231103_hashed.csv (file_format => PO_STAGE_DB."Worker".csv_load_format_skip ) t;

select A.*,d.fiscal_year,d.fiscal_quarter from PO_HRIS_DB."survey".PO_ANNIVERSARY_SURVEY A inner join PO_HRIS_DB."Calender".DIM_DATE d on d.date = a.anniversary_date

outbound/QL_Survey_Anniversary_20240123_hashed.csv

select
$1,
$2,
$3,
$4,
$5,
$6,
$7,
$8,
$9,
$10,
$11,
$12,
$13,
$14,
$15,
$16,
$17,
$18,
$19,
$20,
$21,
$22,
$23,
$24,
$25,
$26,
$27,
$28,
$29,
$30,
$31,
$32,
$33,
$34,
$35,
$36,
$37,
$38,
$39,
$40,
$41,
$42,
$43,
$44,
$45,
$46,
$47,
$48,
$49,
$50,
$51,
$52,
$53,
$54,
$55,
$56,
$57,
$58,
$59,
$60,
$61,
$62,
$63,

$64,
$65,
$66,
$67,
$68,
$69,
$70,
$71,
$72,
$73,
$74,
$75,
$76,
$77,
$78,
$79,
$80,
$81,
$82,
$83,
$84,
$85,
$86,
$87,
$88,
$89,
$90,
$91,
$92,
$93,
$94,
$95,
$96,
$97,
$98,
$99,
$100,
$101,
$102,
$103,
$104,
$105,
$106,
$107,
$108,
$109,
$110,
$111,
$112,
$113,
$114,
$115,
$116,
$117,
$118,
$119,
$120,
$121,
$122,
$123,
$124,
$125,
$126,
$127,
$128,
$129,
$130,
$131,
$132,
$133,
$134,
$135,
$136,
$137,
$138,
$139,
$140,
$141,
$142,
$143,
$144,
$145,
$146,
$147,
$148,
$149,
$150,
$151,
$152,
$153,
$154,
$155,
$156,
$157,
$158,
$159,
$160,
$161,
$162,
$163,
$164,
$165,
$166,
$167,
$168,
$169,
$170,
$171,
$172,
$173,
20231102,
METADATA$FILENAME
from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/outbound/QL_Survey_New_Hire_3_Month_20231110_hashed.csv (file_format => PO_STAGE_DB."Worker".csv_load_format_skip ) t;


insert into PO_ANNIVERSARY_SURVEY_FY20
(
StartDate ,
EndDate ,
Status ,
Progress ,
Duration ,
Finished ,
RecordedDate ,
ResponseId ,
NPS_EMP ,
NPS_MOV ,
NPS_TV ,
CARE_EMP ,
HAP_SPE ,
ASK_HLP ,
PCE_ORG ,
TLS_RSC ,
WRK_OBST ,
TLT_STR ,
WRK_MNG ,
WRK_LNG ,
OPN_MAT ,
IDEA_SHR ,
PRS_REC ,
JOB_EXP ,
CNTR_SUC ,
ACNT_RSLT ,
HON_DISC ,
MGR_FDB ,
MGR_RCMMD ,
GRW_CAR ,
CLR_PTH ,
CAR_GLS ,
CAR_OPP ,
DIV_EXC ,
UND_STRT ,
DEC_TIME ,
VALUE_SPE ,
LDR_CONF ,
SONY_EXC ,
CUST_NEED ,
CUST_VALUE ,
ENV_INV ,
DIF_OPN ,
CRE_APR ,
IDEA_QCK ,
TEAM_COLLAB ,
LRN_GRW ,
EMP_INF ,
INF_SHR ,
LDR_DIV ,
WRK_LFE ,
XTR_EFF ,
CULT_SPE ,
SVY_ACT ,
ENV_SUST ,
TKE_RSK ,
FEEL_FREE ,
Q47 ,
Q48 ,
Q49 ,
Q50 ,
SGST_INV ,
CAR_PTH ,
Anniversary_Date ,
Participant_Email ,
Batch_ID ,
Source_FileName 
)
select 
$1,
$2,
$3,
$4,
$5,
$6,
$7,
$8,
$9,
$10,
$11,
$12,
$13,
$14,
$15,
$16,
$17,
$18,
$19,
$20,
$21,
$22,
$23,
$24,
$25,
$26,
$27,
$28,
$29,
$30,
$31,
$32,
$33,
$34,
$35,
$36,
$37,
$38,
$39,
$40,
$41,
$42,
$43,
$44,
$45,
$46,
$47,
$48,
$49,
$50,
$51,
$52,
$53,
$54,
$55,
$56,
$57,
$58,
$59,
$60,
$61,
$62,
$63,
$64,
$65,
20231128,
METADATA$FILENAME
from @PO_STAGE_DB.PUBLIC.MY_S3_STAGE/Anniversary_Survey_FY2020_hashed_20231108.csv (file_format => PO_STAGE_DB."Worker".csv_load_format ) t;

select * from PO_HRIS_DB."Application".PO_WD_CANDIDATE limit 10
